---
title: æœç´¢ JSON å€¼çš„ JSON å‡½æ•°
summary: äº†è§£æœç´¢ JSON å€¼çš„ JSON å‡½æ•°ã€‚
---

# æœç´¢ JSON å€¼çš„ JSON å‡½æ•°

TiDB æ”¯æŒä½¿ç”¨ MySQL 8.0 ä¸­æä¾›çš„å¤§éƒ¨åˆ†[ç”¨äºæœç´¢ JSON å€¼çš„ JSON å‡½æ•°](https://dev.mysql.com/doc/refman/8.0/en/json-search-functions.html)ã€‚

## `JSON_CONTAINS()`

é€šè¿‡è¿”å› `1` æˆ– `0`ï¼Œ`JSON_CONTAINS(json_doc, candidate [,path])` å‡½æ•°ç”¨äºç¡®è®¤æŒ‡å®šçš„ JSON æ–‡æ¡£ `candidate` æ˜¯å¦åŒ…å«åœ¨ç›®æ ‡ JSON æ–‡æ¡£ä¸­ã€‚

ç¤ºä¾‹ï¼š

ä¸‹é¢ç¤ºä¾‹ä¸­ï¼Œ`a` åŒ…å«åœ¨äº†ç›®æ ‡æ–‡æ¡£ä¸­ã€‚

```sql
SELECT JSON_CONTAINS('["a","b","c"]','"a"');
```

```
+--------------------------------------+
| JSON_CONTAINS('["a","b","c"]','"a"') |
+--------------------------------------+
|                                    1 |
+--------------------------------------+
1 row in set (0.00 sec)
```

ä¸‹é¢ç¤ºä¾‹ä¸­ï¼Œ`a` æ²¡æœ‰åŒ…å«åœ¨ç›®æ ‡æ–‡æ¡£ä¸­ã€‚

```sql
SELECT JSON_CONTAINS('["a","b","c"]','"e"');
```

```
+--------------------------------------+
| JSON_CONTAINS('["a","b","c"]','"e"') |
+--------------------------------------+
|                                    0 |
+--------------------------------------+
1 row in set (0.00 sec)
```

ä¸‹é¢ç¤ºä¾‹ä¸­ï¼Œ`{"foo": "bar"}` åŒ…å«åœ¨äº†ç›®æ ‡æ–‡æ¡£ä¸­ã€‚

```sql
SELECT JSON_CONTAINS('{"foo": "bar", "aaa": 5}','{"foo": "bar"}');
```

```
+------------------------------------------------------------+
| JSON_CONTAINS('{"foo": "bar", "aaa": 5}','{"foo": "bar"}') |
+------------------------------------------------------------+
|                                                          1 |
+------------------------------------------------------------+
1 row in set (0.00 sec)
```

ä¸‹é¢ç¤ºä¾‹ä¸­ï¼Œ`"bar"` æ²¡æœ‰åŒ…å«åœ¨ç›®æ ‡æ–‡æ¡£çš„æ ¹ç›®å½•ä¸­ã€‚

```sql
SELECT JSON_CONTAINS('{"foo": "bar", "aaa": 5}','"bar"');
```

```
+---------------------------------------------------+
| JSON_CONTAINS('{"foo": "bar", "aaa": 5}','"bar"') |
+---------------------------------------------------+
|                                                 0 |
+---------------------------------------------------+
1 row in set (0.00 sec)
```

ä¸‹é¢ç¤ºä¾‹ä¸­ï¼Œ`"bar"` åŒ…å«åœ¨äº†ç›®æ ‡æ–‡æ¡£çš„ `$.foo` å±æ€§ä¸­ã€‚

```sql
SELECT JSON_CONTAINS('{"foo": "bar", "aaa": 5}','"bar"', '$.foo');
```

```
+------------------------------------------------------------+
| JSON_CONTAINS('{"foo": "bar", "aaa": 5}','"bar"', '$.foo') |
+------------------------------------------------------------+
|                                                          1 |
+------------------------------------------------------------+
1 row in set (0.00 sec)
```

## `JSON_CONTAINS_PATH()`

`JSON_CONTAINS_PATH(json_doc,all_or_one,path [,path, ...])` å‡½æ•°è¿”å› `0` æˆ– `1`ï¼Œè¡¨ç¤º JSON æ–‡æ¡£æ˜¯å¦åŒ…å«æŒ‡å®šè·¯å¾„ä¸‹çš„æ•°æ®ã€‚

ç¤ºä¾‹ï¼š

ä¸‹é¢çš„ç¤ºä¾‹æ–‡æ¡£ä¸­åŒ…å« `$.foo`ã€‚

```sql
SELECT JSON_CONTAINS_PATH('{"foo": "bar", "aaa": 5}','all','$.foo');
```

```
+--------------------------------------------------------------+
| JSON_CONTAINS_PATH('{"foo": "bar", "aaa": 5}','all','$.foo') |
+--------------------------------------------------------------+
|                                                            1 |
+--------------------------------------------------------------+
1 row in set (0.00 sec)
```

ä¸‹é¢çš„ç¤ºä¾‹æ–‡æ¡£ä¸­æ²¡æœ‰åŒ…å« `$.bar`ã€‚

```sql
SELECT JSON_CONTAINS_PATH('{"foo": "bar", "aaa": 5}','all','$.bar');
```

```
+--------------------------------------------------------------+
| JSON_CONTAINS_PATH('{"foo": "bar", "aaa": 5}','all','$.bar') |
+--------------------------------------------------------------+
|                                                            0 |
+--------------------------------------------------------------+
1 row in set (0.00 sec)
```

ä¸‹é¢çš„ç¤ºä¾‹æ–‡æ¡£ä¸­åŒ…å«äº† `$.foo` å’Œ `$.aaa`ã€‚

```sql
SELECT JSON_CONTAINS_PATH('{"foo": "bar", "aaa": 5}','all','$.foo', '$.aaa');
```

```
+-----------------------------------------------------------------------+
| JSON_CONTAINS_PATH('{"foo": "bar", "aaa": 5}','all','$.foo', '$.aaa') |
+-----------------------------------------------------------------------+
|                                                                     1 |
+-----------------------------------------------------------------------+
1 row in set (0.00 sec)
```

## `JSON_EXTRACT()`

`JSON_EXTRACT(json_doc, path[, path] ...)` å‡½æ•°ä» JSON æ–‡æ¡£ä¸­æå–ä¸ `path` å‚æ•°åŒ¹é…çš„æ•°æ®ã€‚

```sql
SELECT JSON_EXTRACT('{"foo": "bar", "aaa": 5}', '$.foo');
```

```
+---------------------------------------------------+
| JSON_EXTRACT('{"foo": "bar", "aaa": 5}', '$.foo') |
+---------------------------------------------------+
| "bar"                                             |
+---------------------------------------------------+
1 row in set (0.00 sec)
```

## `->`

`column->path` å‡½æ•°è¿”å› `column` ä¸­ä¸ `path` å‚æ•°åŒ¹é…çš„æ•°æ®ã€‚è¯¥å‡½æ•°æ˜¯ [`JSON_EXTRACT()`](#json_extract) çš„åˆ«åã€‚

```sql
SELECT
    j->'$.foo',
    JSON_EXTRACT(j, '$.foo')
FROM (
    SELECT
        '{"foo": "bar", "aaa": 5}' AS j
    ) AS tbl;
```

```
+------------+--------------------------+
| j->'$.foo' | JSON_EXTRACT(j, '$.foo') |
+------------+--------------------------+
| "bar"      | "bar"                    |
+------------+--------------------------+
1 row in set (0.00 sec)
```

## `->>`

`column->>path` å‡½æ•°å»æ‰ `column` ä¸­ä¸ `path` å‚æ•°åŒ¹é…çš„æ•°æ®çš„å¼•å·ã€‚å®ƒæ˜¯ `JSON_UNQUOTE(JSON_EXTRACT(doc,path_literal))` çš„åˆ«åã€‚

```sql
SELECT
    j->'$.foo',
    JSON_EXTRACT(j, '$.foo')
    j->>'$.foo',
    JSON_UNQUOTE(JSON_EXTRACT(j, '$.foo'))
FROM (
    SELECT
        '{"foo": "bar", "aaa": 5}' AS j
    ) AS tbl;
```

```
+------------+--------------------------+-------------+----------------------------------------+
| j->'$.foo' | JSON_EXTRACT(j, '$.foo') | j->>'$.foo' | JSON_UNQUOTE(JSON_EXTRACT(j, '$.foo')) |
+------------+--------------------------+-------------+----------------------------------------+
| "bar"      | "bar"                    | bar         | bar                                    |
+------------+--------------------------+-------------+----------------------------------------+
1 row in set (0.00 sec)
```

## `JSON_KEYS()`

`JSON_KEYS(json_doc [,path])` å‡½æ•°ä»¥ JSON æ•°ç»„çš„å½¢å¼è¿”å› JSON å¯¹è±¡çš„é¡¶å±‚é”® (key)ã€‚å¦‚æœæŒ‡å®šäº† `path` å‚æ•°ï¼Œåˆ™è¿”å›æ‰€é€‰è·¯å¾„çš„é¡¶å±‚é”® (key)ã€‚

ç¤ºä¾‹ï¼š

ä¸‹é¢ç¤ºä¾‹è¿”å›äº† JSON æ–‡æ¡£ä¸­çš„ä¸¤ä¸ªé¡¶å±‚é”®ã€‚

```sql
SELECT JSON_KEYS('{"name": {"first": "John", "last": "Doe"}, "type": "Person"}');
```

```
+---------------------------------------------------------------------------+
| JSON_KEYS('{"name": {"first": "John", "last": "Doe"}, "type": "Person"}') |
+---------------------------------------------------------------------------+
| ["name", "type"]                                                          |
+---------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

ä¸‹é¢ç¤ºä¾‹è¿”å›äº† JSON æ–‡æ¡£çš„ `$.name` è·¯å¾„ä¸­çš„é¡¶å±‚é”®ã€‚

```sql
SELECT JSON_KEYS('{"name": {"first": "John", "last": "Doe"}, "type": "Person"}', '$.name');
```

```
+-------------------------------------------------------------------------------------+
| JSON_KEYS('{"name": {"first": "John", "last": "Doe"}, "type": "Person"}', '$.name') |
+-------------------------------------------------------------------------------------+
| ["first", "last"]                                                                   |
+-------------------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

## `JSON_SEARCH()`

`JSON_SEARCH(json_doc,one_or_all,str)` å‡½æ•°ä¼šåœ¨ JSON æ–‡æ¡£ä¸­æœç´¢ä¸å­—ç¬¦ä¸²åŒ¹é…çš„ä¸€ä¸ªæˆ–æ‰€æœ‰çš„åŒ¹é…é¡¹ã€‚

ç¤ºä¾‹ï¼š

åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæœç´¢ `cc` çš„ç¬¬ä¸€ä¸ªç»“æœï¼Œå®ƒåœ¨ `a` æ•°ç»„ä¸­ç´¢å¼•ä¸º 2 çš„ä½ç½®ã€‚

```sql
SELECT JSON_SEARCH('{"a": ["aa", "bb", "cc"], "b": ["cc", "dd"]}','one','cc');
```

```
+------------------------------------------------------------------------+
| JSON_SEARCH('{"a": ["aa", "bb", "cc"], "b": ["cc", "dd"]}','one','cc') |
+------------------------------------------------------------------------+
| "$.a[2]"                                                               |
+------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

ç°åœ¨æ‰§è¡Œå’Œä¸Šä¸ªç¤ºä¾‹ç±»ä¼¼çš„æ“ä½œï¼Œä½†å°† `one_or_all` è®¾ç½®ä¸º `all`ã€‚è¿™å°†è·å–å…¨éƒ¨æœç´¢ç»“æœï¼Œè€Œä¸ä»…ä»…æ˜¯ç¬¬ä¸€ä¸ªç»“æœã€‚

```json
SELECT JSON_SEARCH('{"a": ["aa", "bb", "cc"], "b": ["cc", "dd"]}','all','cc');
```

```
+------------------------------------------------------------------------+
| JSON_SEARCH('{"a": ["aa", "bb", "cc"], "b": ["cc", "dd"]}','all','cc') |
+------------------------------------------------------------------------+
| ["$.a[2]", "$.b[0]"]                                                   |
+------------------------------------------------------------------------+
1 row in set (0.01 sec)
```

## `MEMBER OF()`

`str MEMBER OF (json_array)` å‡½æ•°æµ‹è¯•ä¼ å…¥çš„ `str` å€¼æ˜¯å¦æ˜¯ `json_array` çš„å…ƒç´ ï¼Œå¦‚æœæ˜¯åˆ™è¿”å› `1`ï¼Œå¦åˆ™è¿”å› `0`ã€‚å¦‚æœä»»ä¸€å‚æ•°ä¸º `NULL`ï¼Œåˆ™è¿”å› `NULL`ã€‚

```
SELECT 'ğŸ' MEMBER OF ('["ğŸ","ğŸ¥¥","ğŸ¥­"]') AS 'Contains pineapple';
```

```
+--------------------+
| Contains pineapple |
+--------------------+
|                  1 |
+--------------------+
1 row in set (0.00 sec)

```

## `JSON_OVERLAPS()`

`JSON_OVERLAPS(json_doc, json_doc)` å‡½æ•°æ£€æŸ¥ä¸¤ä¸ª JSON æ–‡æ¡£æ˜¯å¦æœ‰é‡å éƒ¨åˆ†ã€‚å¦‚æœæœ‰é‡å ï¼Œåˆ™è¿”å› `1`ï¼Œå¦‚æœæ²¡æœ‰é‡å ï¼Œåˆ™è¿”å› `0`ã€‚å¦‚æœä»»ä¸€å‚æ•°ä¸º `NULL`ï¼Œåˆ™è¿”å› `NULL`ã€‚

ç¤ºä¾‹ï¼š

ä¸‹é¢çš„ç¤ºä¾‹æ˜¾ç¤ºæ²¡æœ‰é‡å ï¼Œå› ä¸ºæ•°ç»„å€¼çš„å…ƒç´ æ•°é‡ä¸ä¸€æ ·ã€‚

```sql
SELECT JSON_OVERLAPS(
    '{"languages": ["Go","Rust","C#"]}',
    '{"languages": ["Go","Rust"]}'
) AS 'Overlaps';
```

```
+----------+
| Overlaps |
+----------+
|        0 |
+----------+
1 row in set (0.00 sec)
```

ä¸‹é¢çš„ç¤ºä¾‹æ˜¾ç¤ºä¸¤ä¸ª JSON æ–‡æ¡£é‡å ï¼Œå› ä¸ºå®ƒä»¬å®Œå…¨ç›¸åŒã€‚

```sql
SELECT JSON_OVERLAPS(
    '{"languages": ["Go","Rust","C#"]}',
    '{"languages": ["Go","Rust","C#"]}'
) AS 'Overlaps';
```

```
+----------+
| Overlaps |
+----------+
|        1 |
+----------+
1 row in set (0.00 sec)
```

ä¸‹é¢çš„ç¤ºä¾‹æ˜¾ç¤ºå­˜åœ¨é‡å ï¼Œè€Œç¬¬äºŒä¸ªæ–‡ä»¶æœ‰ä¸€ä¸ªé¢å¤–çš„å±æ€§ã€‚

```sql
SELECT JSON_OVERLAPS(
    '{"languages": ["Go","Rust","C#"]}',
    '{"languages": ["Go","Rust","C#"], "arch": ["arm64"]}'
) AS 'Overlaps';
```

```
+----------+
| Overlaps |
+----------+
|        1 |
+----------+
1 row in set (0.00 sec)
```

## å¦è¯·å‚é˜…

- [JSON å‡½æ•°](/functions-and-operators/json-functions.md)
- [JSON æ•°æ®ç±»å‹](/data-type-json.md)