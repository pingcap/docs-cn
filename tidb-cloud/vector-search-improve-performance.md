---
title: 提升向量搜索性能
summary: 了解提升 TiDB 向量搜索性能的最佳实践。
---

# 提升向量搜索性能

TiDB 向量搜索使你能够执行近似最近邻（ANN）查询，搜索与图像、文档或其他输入相似的结果。要提高查询性能，请参考以下最佳实践。

## 为向量列添加向量搜索索引

[向量搜索索引](/tidb-cloud/vector-search-index.md)能显著提高向量搜索查询的性能，通常能提升 10 倍或更多，只需要牺牲很小的召回率。

## 确保向量索引完全构建

在插入大量向量数据后，其中一部分可能在 Delta 层等待持久化。这些数据的向量索引将在数据持久化后构建。在所有向量数据都被索引之前，向量搜索性能是次优的。要检查索引构建进度，请参见[查看索引构建进度](/tidb-cloud/vector-search-index.md#view-index-build-progress)。

## 减少向量维度或缩短嵌入

随着向量维度的增加，向量搜索索引和查询的计算复杂度显著增加，需要更多的浮点数比较。

为了优化性能，请在可行的情况下考虑减少向量维度。这通常需要切换到另一个嵌入模型。切换模型时，你需要评估模型变更对向量查询准确性的影响。

某些嵌入模型（如 OpenAI `text-embedding-3-large`）支持[缩短嵌入](https://openai.com/index/new-embedding-models-and-api-updates/)，即从向量序列末尾删除一些数字，而不会丢失嵌入的概念表示属性。你也可以使用这样的嵌入模型来减少向量维度。

## 从结果中排除向量列

向量嵌入数据通常很大，且仅在搜索过程中使用。通过从查询结果中排除向量列，你可以大大减少 TiDB 服务器和 SQL 客户端之间传输的数据量，从而提高查询性能。

要排除向量列，请在 `SELECT` 子句中明确列出你想要检索的列，而不是使用 `SELECT *` 检索所有列。

## 预热索引

当访问从未使用过或长时间未访问（冷访问）的索引时，TiDB 需要从云存储或磁盘（而不是从内存）加载整个索引。这个过程需要时间，通常会导致更高的查询延迟。此外，如果长时间（例如几个小时）没有 SQL 查询，计算资源会被回收，导致后续访问变成冷访问。

为了避免这种查询延迟，请在实际工作负载之前通过运行命中向量索引的类似向量搜索查询来预热索引。
