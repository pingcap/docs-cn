---
title: 备份和恢复 TiDB Cloud Serverless 数据
summary: 了解如何备份和恢复 TiDB Cloud Serverless 集群。
aliases: ['/tidbcloud/restore-deleted-tidb-cluster']
---

# 备份和恢复 TiDB Cloud Serverless 数据

本文介绍如何在 TiDB Cloud 上备份和恢复 TiDB Cloud Serverless 集群数据。

> **提示：**
>
> 要了解如何备份和恢复 TiDB Cloud Dedicated 集群数据，请参阅[备份和恢复 TiDB Cloud Dedicated 数据](/tidb-cloud/backup-and-restore.md)。

## 查看备份页面

1. 在[**集群**](https://tidbcloud.com/project/clusters)页面，点击目标集群的名称进入其概览页面。

    > **提示：**
    >
    > 你可以使用左上角的组合框在组织、项目和集群之间切换。

2. 在左侧导航栏中，点击**数据** > **备份**。

## 自动备份

TiDB Cloud Serverless 自动备份你的集群数据，允许你从备份快照恢复数据，以在发生灾难时最大限度地减少数据丢失。

### 了解备份设置

免费集群和可扩展集群的自动备份设置有所不同，如下表所示：

| 备份设置   | 免费集群 | 可扩展集群 |
|------------------|--------------|------------------|
| 备份周期     | 每日        | 每日            |
| 备份保留期 | 1 天        | 14 天          |
| 备份时间      | 固定时间   | 可配置     |

- **备份周期**是进行备份的频率。

- **备份保留期**是备份保留的时间。过期的备份无法恢复。
   
- **备份时间**是开始调度备份的时间。注意，最终的备份时间可能会晚于配置的备份时间。
   
    - 免费集群：备份时间是随机固定的时间。
    - 可扩展集群：你可以将备份时间配置为每半小时。默认值是随机固定的时间。

### 配置备份设置

要为可扩展集群设置备份时间，请执行以下步骤：

1. 导航到集群的[**备份**](#查看备份页面)页面。

2. 点击**备份设置**。这将打开**备份设置**窗口，你可以根据需求配置自动备份设置。

3. 在**备份时间**中，为每日集群备份安排一个开始时间。

4. 点击**确认**。

## 恢复

TiDB Cloud Serverless 集群提供恢复功能，帮助在意外数据丢失或损坏时恢复数据。

### 恢复模式

TiDB Cloud Serverless 支持集群的快照恢复和时间点恢复。

- **快照恢复**：从特定备份快照恢复集群。

- **时间点恢复（beta）**：将集群恢复到特定时间点。

    - 免费集群：不支持。
    - 可扩展集群：可以恢复到过去 14 天内的任意时间点，但不能早于集群创建时间或晚于当前时间减去一分钟。

### 恢复目标

TiDB Cloud Serverless 支持原地恢复和恢复到新集群。

**原地恢复**

恢复到当前集群将覆盖现有数据。请注意以下事项：

- 一旦开始恢复，现有连接将被终止。
- 在恢复过程中，集群将不可用，新的连接将被阻止。
- 恢复将影响 `mysql` 架构中的表。对用户凭据、权限或系统变量的任何更改都将恢复到备份时的状态。

**恢复到新集群**

创建并恢复到新集群。请注意以下事项：

- 源集群的用户凭据和权限不会恢复到新集群。

### 恢复超时

恢复过程通常在几分钟内完成。如果恢复时间超过三小时，将自动取消。取消恢复的结果取决于目标：

- **原地恢复**：集群状态从**恢复中**变为**可用**，集群变为可访问。
- **恢复到新集群**：新集群被删除，源集群保持不变。

如果取消恢复后数据损坏且无法恢复，请联系 [TiDB Cloud 支持团队](/tidb-cloud/tidb-cloud-support.md)寻求帮助。

### 执行恢复

要恢复你的 TiDB Cloud Serverless 集群，请按照以下步骤操作：

1. 导航到集群的[**备份**](#查看备份页面)页面。

2. 点击**恢复**。设置窗口显示。

3. 在**恢复模式**中，你可以选择从特定备份恢复或从任意时间点恢复。

    <SimpleTab>
    <div label="快照恢复">

    要从选定的备份快照恢复，请执行以下步骤：

    1. 点击**快照恢复**。
    2. 选择要恢复的备份快照。

    </div>
    <div label="时间点恢复">

    要将可扩展集群恢复到特定时间点，请执行以下步骤：

    1. 点击**时间点恢复**。
    2. 选择要恢复到的日期和时间。

    </div>
    </SimpleTab>

4. 在**目标**中，你可以选择恢复到新集群或原地恢复。

    <SimpleTab>
    <div label="恢复到新集群">

    要恢复到新集群，请执行以下步骤：

    1. 点击**恢复到新集群**。
    2. 为新集群输入名称。
    3. 为新集群选择集群方案。
    4. 如果你选择可扩展集群，请设置每月支出限额，然后根据需要配置高级设置。否则，跳过此步骤。

    </div>
    <div label="原地恢复">

    要原地恢复，点击**原地恢复**。

    </div>
    </SimpleTab>

5. 点击**恢复**开始恢复过程。

一旦恢复过程开始，集群状态将变为**恢复中**。集群将保持不可用状态，直到恢复完成且状态变为**可用**。

## 限制

- 如果启用了 TiFlash 副本，在恢复后它将在一段时间内不可用，因为数据需要在 TiFlash 中重建。
- TiDB Cloud Serverless 集群不支持手动备份。
- 默认情况下，数据量超过 1 TiB 的集群不支持恢复到新集群。如需处理更大的数据集，请联系 [TiDB Cloud 支持团队](/tidb-cloud/tidb-cloud-support.md)寻求帮助。
