---
title: 管理端点
summary: 了解如何在 TiDB Cloud 控制台中创建、开发、测试、部署和删除 Data App 中的端点。
---

# 管理端点

Data Service（测试版）中的端点是一个可以自定义执行 SQL 语句的 Web API。你可以为 SQL 语句指定参数，例如在 `WHERE` 子句中使用的值。当客户端调用端点并在请求 URL 中提供参数值时，端点会使用提供的参数执行 SQL 语句，并将结果作为 HTTP 响应的一部分返回。

本文介绍如何在 TiDB Cloud 控制台中管理 Data App 中的端点。

## 开始之前

- 在创建端点之前，请确保以下内容：

    - 你已创建集群和 Data App。更多信息，请参见[创建 Data App](/tidb-cloud/data-service-manage-data-app.md#create-a-data-app)。
    - 端点将要操作的数据库、表和列已经存在于目标集群中。

- 在调用端点之前，请确保你已在 Data App 中创建了 API 密钥。更多信息，请参见[创建 API 密钥](/tidb-cloud/data-service-api-key.md#create-an-api-key)。

## 创建端点

在 Data Service 中，你可以自动生成端点、手动创建端点或添加预定义的系统端点。

> **提示：**
>
> 你也可以从 SQL Editor 中的 SQL 文件创建端点。更多信息，请参见[从 SQL 文件生成端点](/tidb-cloud/explore-data-with-chat2query.md#generate-an-endpoint-from-a-sql-file)。

### 自动生成端点

在 TiDB Cloud Data Service 中，你可以按以下方式一次性自动生成一个或多个端点：

1. 导航到项目的 [**Data Service**](https://tidbcloud.com/project/data-service) 页面。
2. 在左侧窗格中，找到目标 Data App，点击 App 名称右侧的 **+**，然后点击**自动生成端点**。此时会显示端点生成对话框。
3. 在对话框中，执行以下操作：

    1. 为要生成的端点选择目标集群、数据库和表。

        > **注意：**
        >
        > **表**下拉列表仅包含至少有一列的用户定义表，不包括系统表和没有列定义的表。

    2. 为要生成的端点选择至少一个 HTTP 操作（如 `GET（检索）`、`POST（创建）`和 `PUT（更新）`）。

        对于你选择的每个操作，TiDB Cloud Data Service 将生成一个相应的端点。如果你选择批量操作（如 `POST（批量创建）`），生成的端点允许你在单个请求中操作多行数据。

        如果你选择的表包含[向量数据类型](/tidb-cloud/vector-search-data-types.md)，你可以启用**向量搜索操作**选项并选择向量距离函数，以生成一个向量搜索端点，该端点会根据你选择的距离函数自动计算向量距离。支持的[向量距离函数](/tidb-cloud/vector-search-functions-and-operators.md)包括：

        - `VEC_L2_DISTANCE`（默认）：计算两个向量之间的 L2 距离（欧几里得距离）。
        - `VEC_COSINE_DISTANCE`：计算两个向量之间的余弦距离。
        - `VEC_NEGATIVE_INNER_PRODUCT`：使用两个向量之间内积的负值计算距离。
        - `VEC_L1_DISTANCE`：计算两个向量之间的 L1 距离（曼哈顿距离）。
       
    3. （可选）为操作配置超时时间和标签。所有生成的端点将自动继承配置的属性，可以根据需要稍后修改。
    4. （可选）**自动部署端点**选项（默认禁用）控制是否启用生成端点的直接部署。启用时，将跳过草稿审查过程，生成的端点将立即部署，无需进一步手动审查或批准。

4. 点击**生成**。

    生成的端点显示在端点列表的顶部。

5. 检查新端点的生成端点名称、SQL 语句、属性和参数。

    - 端点名称：生成的端点名称采用 `/<选择的表名>` 格式，请求方法（如 `GET`、`POST` 和 `PUT`）显示在端点名称之前。例如，如果选择的表名是 `sample_table` 且选择的操作是 `POST（创建）`，生成的端点显示为 `POST /sample_table`。

        - 如果选择了批量操作，TiDB Cloud Data Service 会在生成的端点名称后附加 `/bulk`。例如，如果选择的表名是 `/sample_table` 且选择的操作是 `POST（批量创建）`，生成的端点显示为 `POST /sample_table/bulk`。
        - 如果选择了 `POST（向量相似度搜索）`，TiDB Cloud Data Service 会在生成的端点名称后附加 `/vector_search`。例如，如果选择的表名是 `/sample_table` 且选择的操作是 `POST（向量相似度搜索）`，生成的端点显示为 `POST /sample_table/vector_search`。
        - 如果已经存在具有相同请求方法和端点名称的端点，TiDB Cloud Data Service 会在生成的端点名称后附加 `_dump_<随机字母>`。例如，`/sample_table_dump_EUKRfl`。

    - SQL 语句：TiDB Cloud Data Service 根据表列规范和选择的端点操作自动编写生成端点的 SQL 语句。你可以点击端点名称在页面中间部分查看其 SQL 语句。
    - 端点属性：TiDB Cloud Data Service 根据你的选择自动配置端点路径、请求方法、超时时间和标签。你可以在页面右侧窗格中找到这些属性。
    - 端点参数：TiDB Cloud Data Service 自动为生成的端点配置参数。你可以在页面右侧窗格中找到这些参数。

6. 如果你想修改生成端点的详细信息，如名称、SQL 语句、属性或参数，请参考[开发端点](#开发端点)中提供的说明。

### 手动创建端点

要手动创建端点，请执行以下步骤：

1. 导航到项目的 [**Data Service**](https://tidbcloud.com/project/data-service) 页面。
2. 在左侧窗格中，找到目标 Data App，点击 App 名称右侧的 **+**，然后点击**创建端点**。
3. 如有必要，更新默认名称。新创建的端点将添加到端点列表的顶部。
4. 根据[开发端点](#开发端点)中的说明配置新端点。

### 添加预定义系统端点

Data Service 提供了一个包含预定义系统端点的端点库，你可以直接将这些端点添加到你的 Data App 中，从而减少端点开发的工作量。目前，该库仅包含 `/system/query` 端点，该端点允许你通过简单地在预定义的 `sql` 参数中传递语句来执行任何 SQL 语句。

要将预定义系统端点添加到你的 Data App 中，请执行以下步骤：

1. 导航到项目的 [**Data Service**](https://tidbcloud.com/project/data-service) 页面。

2. 在左侧窗格中，找到目标 Data App，点击 App 名称右侧的 **+**，然后点击**管理端点库**。

    此时会显示端点库管理对话框。目前，对话框中仅提供**执行查询**（即 `/system/query` 端点）。

3. 要将 `/system/query` 端点添加到你的 Data App 中，将**执行查询**开关切换到**已添加**。

    > **提示：**
    >
    > 要从你的 Data App 中删除已添加的预定义端点，将**执行查询**开关切换到**已删除**。

4. 点击**保存**。

    > **注意：**
    >
    > - 点击**保存**后，添加或删除的端点会立即部署到生产环境，这使得添加的端点立即可访问，删除的端点立即不可访问。
    > - 如果当前 App 中已存在具有相同路径和方法的非预定义端点，系统端点的创建将失败。

    添加的系统提供的端点将显示在端点列表的顶部。

5. 检查新端点的端点名称、SQL 语句、属性和参数。

    > **注意：**
    >
    > `/system/query` 端点功能强大且通用，但可能具有破坏性。请谨慎使用，并确保查询是安全的且经过充分考虑，以防止意外后果。

    - 端点名称：端点名称和路径为 `/system/query`，请求方法为 `POST`。
    - SQL 语句：`/system/query` 端点不附带任何 SQL 语句。你可以在页面中间部分找到 SQL 编辑器，并在其中编写所需的 SQL 语句。请注意，为 `/system/query` 端点编写的 SQL 语句将保存在 SQL 编辑器中，以便你下次可以进一步开发和测试，但不会保存在端点配置中。
    - 端点属性：在页面右侧窗格的**属性**标签页中，你可以找到端点属性。与其他自定义端点不同，系统端点只能自定义 `timeout` 和 `max rows` 属性。
    - 端点参数：在页面右侧窗格的**参数**标签页中，你可以找到端点参数。`/system/query` 端点的参数是自动配置的，不能修改。

## 开发端点

对于每个端点，你可以编写要在 TiDB 集群上执行的 SQL 语句，为 SQL 语句定义参数，或管理名称和版本。

> **注意：**
>
> 如果你已将 Data App 连接到 GitHub 并启用了**自动同步和部署**，你也可以使用 GitHub 更新端点配置。你在 GitHub 中所做的任何更改都将自动部署在 TiDB Cloud Data Service 中。更多信息，请参见[使用 GitHub 自动部署](/tidb-cloud/data-service-manage-github-connection.md)。

### 配置属性

在端点详情页面的右侧窗格中，你可以点击**属性**标签页来查看和配置端点的属性。

#### 基本属性

- **路径**：用户用来访问端点的路径。

#### 高级属性

- **超时时间（毫秒）**：端点的超时时间，以毫秒为单位。
- **最大行数**：端点可以操作或返回的最大行数。
- **标签**：用于标识一组端点的标签。
- **分页**：此属性仅在请求方法为 `GET` 且端点的最后一个 SQL 语句是 `SELECT` 操作时可用。当启用**分页**时，你可以在调用端点时通过指定 `page` 和 `page_size` 作为查询参数来对结果进行分页，例如 `https://<region>.data.tidbcloud.com/api/v1beta/app/<App ID>/endpoint/my_endpoint/get_id?page=<页码>&page_size=<每页大小>`。更多信息，请参见[调用端点](#调用端点)。

    > **注意：**
    >
    > - 如果你在请求中不包含 `page` 和 `page_size` 参数，默认行为是在单个页面上返回**最大行数**属性中指定的最大行数。
    > - `page_size` 必须小于或等于**最大行数**属性。否则，将返回错误。

- **缓存响应**：此属性仅在请求方法为 `GET` 时可用。当启用**缓存响应**时，TiDB Cloud Data Service 可以在指定的生存时间（TTL）期间内缓存你的 `GET` 请求返回的响应。
- **生存时间（秒）**：此属性仅在启用**缓存响应**时可用。你可以使用它来指定缓存响应的生存时间（TTL）期间，以秒为单位。在 TTL 期间内，如果你再次发出相同的 `GET` 请求，Data Service 会直接返回缓存的响应，而不是再次从目标数据库获取数据，这提高了你的查询性能。
- **批量操作**：此属性仅在请求方法为 `POST` 或 `PUT` 时可见。当启用**批量操作**时，你可以在单个请求中操作多行数据。例如，在[调用端点](#调用端点)时，你可以通过在 curl 命令的 `--data-raw` 选项中将数据对象数组放入对象的 `items` 字段来在单个 `POST` 请求中插入多行数据。

    > **注意：**
    >
    > 启用**批量操作**的端点支持请求体的数组和对象格式：`[{dataObject1}, {dataObject2}]` 和 `{items: [{dataObject1}, {dataObject2}]}`。为了更好地与其他系统兼容，建议使用对象格式 `{items: [{dataObject1}, {dataObject2}]}`。

### 编写 SQL 语句

在端点详情页面的 SQL 编辑器中，你可以编写和运行端点的 SQL 语句。你也可以简单地输入 `--` 后跟你的指令，让 AI 自动生成 SQL 语句。

1. 选择集群。

    > **注意：**
    >
    > 下拉列表中只显示链接到 Data App 的集群。要管理链接的集群，请参见[管理链接的数据源](/tidb-cloud/data-service-manage-data-app.md#manage-linked-data-sources)。

    在 SQL 编辑器的上部，从下拉列表中选择你想要执行 SQL 语句的集群。然后，你可以在右侧窗格的**架构**标签页中查看此集群的所有数据库。

2. 根据你的端点类型，执行以下操作之一来选择数据库：

    - 预定义系统端点：在 SQL 编辑器的上部，从下拉列表中选择目标数据库。
    - 其他端点：在 SQL 编辑器中编写 SQL 语句来指定目标数据库。例如，`USE database_name;`。

3. 编写 SQL 语句。

    在 SQL 编辑器中，你可以编写诸如表连接查询、复杂查询和聚合函数等语句。你也可以简单地输入 `--` 后跟你的指令，让 AI 自动生成 SQL 语句。

    要定义参数，你可以在 SQL 语句中将其作为变量占位符插入，如 `${ID}`。例如，`SELECT * FROM table_name WHERE id = ${ID}`。然后，你可以点击右侧窗格的**参数**标签页来更改参数定义和测试值。更多信息，请参见[参数](#配置参数)。

    在定义数组参数时，参数会自动转换为 SQL 语句中的多个逗号分隔值。为确保 SQL 语句有效，你需要在某些 SQL 语句（如 `IN`）中在参数周围添加括号（`()`）。例如，如果你定义一个测试值为 `1,2,3` 的数组参数 `ID`，使用 `SELECT * FROM table_name WHERE id IN (${ID})` 来查询数据。

    > **注意：**
    >
    > - 参数名称区分大小写。
    > - 参数不能用作表名或列名。

4. 运行 SQL 语句。

    如果你在 SQL 语句中插入了参数，请确保你已在右侧窗格的**参数**标签页中为参数设置了测试值或默认值。否则，将返回错误。

    <SimpleTab>
    <div label="macOS">

    对于 macOS：

    - 如果编辑器中只有一个语句，要运行它，请按 **⌘ + Enter** 或点击 <svg width="1rem" height="1rem" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.70001 20.7756C6.01949 20.3926 6.00029 19.5259 6.00034 19.0422L6.00034 12.1205L6 5.33028C6 4.75247 6.00052 3.92317 6.38613 3.44138C6.83044 2.88625 7.62614 2.98501 7.95335 3.05489C8.05144 3.07584 8.14194 3.12086 8.22438 3.17798L19.2865 10.8426C19.2955 10.8489 19.304 10.8549 19.3126 10.8617C19.4069 10.9362 20 11.4314 20 12.1205C20 12.7913 19.438 13.2784 19.3212 13.3725C19.307 13.3839 19.2983 13.3902 19.2831 13.4002C18.8096 13.7133 8.57995 20.4771 8.10002 20.7756C7.60871 21.0812 7.22013 21.0683 6.70001 20.7756Z" fill="currentColor"></path></svg>**运行**。

    - 如果编辑器中有多个语句，要按顺序运行其中一个或多个语句，请将光标放在目标语句上或用光标选择目标语句的行，然后按 **⌘ + Enter** 或点击**运行**。

    - 要按顺序运行编辑器中的所有语句，请按 **⇧ + ⌘ + Enter**，或用光标选择所有语句的行并点击**运行**。

    </div>

    <div label="Windows/Linux">

    对于 Windows 或 Linux：

    - 如果编辑器中只有一个语句，要运行它，请按 **Ctrl + Enter** 或点击 <svg width="1rem" height="1rem" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.70001 20.7756C6.01949 20.3926 6.00029 19.5259 6.00034 19.0422L6.00034 12.1205L6 5.33028C6 4.75247 6.00052 3.92317 6.38613 3.44138C6.83044 2.88625 7.62614 2.98501 7.95335 3.05489C8.05144 3.07584 8.14194 3.12086 8.22438 3.17798L19.2865 10.8426C19.2955 10.8489 19.304 10.8549 19.3126 10.8617C19.4069 10.9362 20 11.4314 20 12.1205C20 12.7913 19.438 13.2784 19.3212 13.3725C19.307 13.3839 19.2983 13.3902 19.2831 13.4002C18.8096 13.7133 8.57995 20.4771 8.10002 20.7756C7.60871 21.0812 7.22013 21.0683 6.70001 20.7756Z" fill="currentColor"></path></svg>**运行**。

    - 如果编辑器中有多个语句，要按顺序运行其中一个或多个语句，请将光标放在目标语句上或用光标选择目标语句的行，然后按 **Ctrl + Enter** 或点击**运行**。

    - 要按顺序运行编辑器中的所有语句，请按 **Shift + Ctrl + Enter**，或用光标选择所有语句的行并点击**运行**。

    </div>
    </SimpleTab>

    运行语句后，你可以在页面底部的**结果**标签页中立即看到查询结果。

    > **注意：**
    >
    > 返回的结果大小限制为 8 MiB。

### 配置参数

在端点详情页面的右侧窗格中，你可以点击**参数**标签页来查看和管理端点中使用的参数。

在**定义**部分，你可以查看和管理参数的以下属性：

- 参数名称：名称只能包含字母、数字和下划线（`_`），并且必须以字母或下划线（`_`）开头。**不要**使用 `page` 和 `page_size` 作为参数名称，这些是为请求结果分页保留的。
- **必需**：指定参数在请求中是否是必需的。对于路径参数，配置是必需的且不能修改。对于其他参数，默认配置是不必需的。
- **类型**：指定参数的数据类型。对于路径参数，只支持 `STRING` 和 `INTEGER`。对于其他参数，支持 `STRING`、`NUMBER`、`INTEGER`、`BOOLEAN` 和 `ARRAY`。

    使用 `STRING` 类型参数时，不需要添加引号（`'` 或 `"`）。例如，`foo` 对于 `STRING` 类型是有效的，并被处理为 `"foo"`，而 `"foo"` 被处理为 `"\"foo\""`。

- **枚举值**：（可选）指定参数的有效值，仅在参数类型为 `STRING`、`INTEGER` 或 `NUMBER` 时可用。

    - 如果将此字段留空，参数可以是指定类型的任何值。
    - 要指定多个有效值，可以用逗号（`,`）分隔它们。例如，如果你将参数类型设置为 `STRING` 并将此字段指定为 `foo, bar`，则参数值只能是 `foo` 或 `bar`。

- **项目类型**：指定 `ARRAY` 类型参数的项目类型。
- **默认值**：指定参数的默认值。

    - 对于 `ARRAY` 类型，你需要用逗号（`,`）分隔多个值。
    - 确保值可以转换为参数的类型。否则，端点将返回错误。
    - 如果你没有为参数设置测试值，在测试端点时将使用默认值。
- **位置**：指示参数的位置。此属性不能修改。
    - 对于路径参数，此属性为 `Path`。
    - 对于其他参数，如果请求方法为 `GET` 或 `DELETE`，此属性为 `Query`。如果请求方法为 `POST` 或 `PUT`，此属性为 `Body`。

在**测试值**部分，你可以查看和设置测试参数。这些值在你测试端点时用作参数值。确保值可以转换为参数的类型。否则，端点将返回错误。

### 重命名

要重命名端点，请执行以下步骤：

1. 导航到项目的 [**Data Service**](https://tidbcloud.com/project/data-service) 页面。
2. 在左侧窗格中，点击目标 Data App 的名称以查看其端点。
3. 找到要重命名的端点，点击 **...** > **重命名**，然后为端点输入新名称。

> **注意：**
>
> 预定义系统端点不支持重命名。

## 测试端点

要测试端点，请执行以下步骤：

> **提示：**
>
> 如果你已将 Data App 导入到 Postman，你也可以在 Postman 中测试 Data App 的端点。更多信息，请参见[在 Postman 中运行 Data App](/tidb-cloud/data-service-postman-integration.md)。

1. 导航到项目的 [**Data Service**](https://tidbcloud.com/project/data-service) 页面。
2. 在左侧窗格中，点击目标 Data App 的名称以查看其端点。
3. 点击要测试的端点的名称以查看其详细信息。
4. （可选）如果端点包含参数，你需要在测试之前设置测试值。

    1. 在端点详情页面的右侧窗格中，点击**参数**标签页。
    2. 展开**测试值**部分并为参数设置测试值。

        如果你没有为参数设置测试值，将使用默认值。

5. 点击右上角的**测试**。

    > **提示：**
    >
    > 或者，你也可以按 <kbd>F5</kbd> 来测试端点。

测试端点后，你可以在页面底部看到 JSON 格式的响应。有关 JSON 响应的更多信息，请参考[端点的响应](#响应)。

## 部署端点

> **注意：**
>
> 如果你已将 Data App 连接到 GitHub 并启用了**自动同步和部署**，你在 GitHub 中所做的任何 Data App 更改都将自动部署在 TiDB Cloud Data Service 中。更多信息，请参见[使用 GitHub 自动部署](/tidb-cloud/data-service-manage-github-connection.md)。

要部署端点，请执行以下步骤：

1. 导航到项目的 [**Data Service**](https://tidbcloud.com/project/data-service) 页面。
2. 在左侧窗格中，点击目标 Data App 的名称以查看其端点。
3. 找到要部署的端点，点击端点名称以查看其详细信息，然后点击右上角的**部署**。
4. 如果为你的 Data App 启用了**审查草稿**，将显示一个对话框供你审查所做的更改。你可以根据审查决定是否放弃更改。
5. 点击**部署**确认部署。如果端点成功部署，你将收到**端点已部署**提示。

    在端点详情页面的右侧窗格中，你可以点击**部署**标签页查看部署历史。

## 调用端点

要调用端点，你可以向端点的未部署草稿版本或已部署在线版本发送 HTTPS 请求。

> **提示：**
>
> 如果你已将 Data App 导入到 Postman，你也可以在 Postman 中调用 Data App 的端点。更多信息，请参见[在 Postman 中运行 Data App](/tidb-cloud/data-service-postman-integration.md)。

### 前提条件

在调用端点之前，你需要创建 API 密钥。更多信息，请参考[创建 API 密钥](/tidb-cloud/data-service-api-key.md#create-an-api-key)。

### 请求

TiDB Cloud Data Service 生成代码示例来帮助你调用端点。要获取代码示例，请执行以下步骤：

1. 导航到项目的 [**Data Service**](https://tidbcloud.com/project/data-service) 页面。
2. 在左侧窗格中，点击目标 Data App 的名称以查看其端点。
3. 找到要调用的端点并点击 **...** > **代码示例**。此时会显示**代码示例**对话框。

    > **提示：**
    >
    > 或者，你也可以点击端点名称以查看其详细信息，然后点击右上角的 **...** > **代码示例**。

4. 在对话框中，选择你要用来调用端点的环境和认证方法，然后复制代码示例。

    > **注意：**
    >
    > - 代码示例是根据端点的属性和参数生成的。
    > - 目前，TiDB Cloud Data Service 仅提供 curl 代码示例。

    - 环境：根据你的需要选择**测试环境**或**在线环境**。**在线环境**仅在你部署端点后可用。
    - 认证方法：选择**基本认证**或**摘要认证**。
        - **基本认证**以 base64 编码文本的形式传输你的 API 密钥。
        - **摘要认证**以加密形式传输你的 API 密钥，这更安全。

      与**基本认证**相比，**摘要认证**的 curl 代码包含一个额外的 `--digest` 选项。

    以下是启用**批量操作**并使用**摘要认证**的 `POST` 请求的 curl 代码片段示例：

    <SimpleTab>
    <div label="测试环境">

    要调用端点的草稿版本，你需要添加 `endpoint-type: draft` 头：

    ```bash
    curl --digest --user '<Public Key>:<Private Key>' \
     --request POST 'https://<region>.data.tidbcloud.com/api/v1beta/app/<App ID>/endpoint/<Endpoint Path>' \
     --header 'content-type: application/json'\
     --header 'endpoint-type: draft'
     --data-raw '{
      "items": [
        {
          "age": "${age}",
          "career": "${career}"
        }
      ]
    }'
    ```

    </div>

    <div label="在线环境">

    你必须先部署端点，然后才能在在线环境中查看代码示例。

    要调用端点的当前在线版本，使用以下命令：

    ```bash
    curl --digest --user '<Public Key>:<Private Key>' \
     --request POST 'https://<region>.data.tidbcloud.com/api/v1beta/app/<App ID>/endpoint/<Endpoint Path>' \
     --header 'content-type: application/json'\
     --data-raw '{
      "items": [
        {
          "age": "${age}",
          "career": "${career}"
        }
      ]
    }'
    ```

    </div>
    </SimpleTab>

    > **注意：**
    >
    > - 通过请求区域域名 `<region>.data.tidbcloud.com`，你可以直接访问 TiDB 集群所在区域的端点。
    > - 或者，你也可以请求全局域名 `data.tidbcloud.com` 而不指定区域。这样，TiDB Cloud Data Service 将在内部将请求重定向到目标区域，但这可能会导致额外的延迟。如果你选择这种方式，请确保在调用端点时在 curl 命令中添加 `--location-trusted` 选项。

5. 将代码示例粘贴到你的应用程序中，根据需要编辑示例，然后运行它。

    - 你需要将 `<Public Key>` 和 `<Private Key>` 占位符替换为你的 API 密钥。更多信息，请参考[管理 API 密钥](/tidb-cloud/data-service-api-key.md)。
    - 如果你的端点的请求方法为 `GET` 且为端点启用了**分页**，你可以通过用所需的值更新 `page=<页码>` 和 `page_size=<每页大小>` 的值来对结果进行分页。例如，要获取每页 10 项的第二页，使用 `page=2` 和 `page_size=10`。
    - 如果你的端点的请求方法为 `POST` 或 `PUT`，根据你要操作的数据行填写 `--data-raw` 选项。

        - 对于启用了**批量操作**的端点，`--data-raw` 选项接受一个包含数据对象数组的 `items` 字段的对象，这样你可以使用一个端点操作多行数据。
        - 对于未启用**批量操作**的端点，`--data-raw` 选项只接受一个数据对象。

    - 如果端点包含参数，在调用端点时指定参数值。

### 响应

调用端点后，你可以看到 JSON 格式的响应。更多信息，请参见 [Data Service 的响应和状态码](/tidb-cloud/data-service-response-and-status-code.md)。

## 取消部署端点

> **注意：**
>
> 如果你已[将 Data App 连接到 GitHub](/tidb-cloud/data-service-manage-github-connection.md) 并启用了**自动同步和部署**，取消部署此 Data App 的端点也会删除 GitHub 上此端点的配置。

要取消部署端点，请执行以下步骤：

1. 导航到项目的 [**Data Service**](https://tidbcloud.com/project/data-service) 页面。
2. 在左侧窗格中，点击目标 Data App 的名称以查看其端点。
3. 找到要取消部署的端点，点击 **...** > **取消部署**。
4. 点击**取消部署**确认取消部署。

## 删除端点

> **注意：**
>
> 在删除端点之前，请确保端点不在线。否则，无法删除端点。要取消部署端点，请参考[取消部署端点](#取消部署端点)。

要删除端点，请执行以下步骤：

1. 导航到项目的 [**Data Service**](https://tidbcloud.com/project/data-service) 页面。
2. 在左侧窗格中，点击目标 Data App 的名称以查看其端点。
3. 点击要删除的端点的名称，然后点击右上角的 **...** > **删除**。
4. 点击**删除**确认删除。

    - 路径长度必须小于 64 个字符。
    - 请求方法和路径的组合在 Data App 内必须是唯一的。
    - 路径中只允许使用字母、数字、下划线（`_`）、斜杠（`/`）和用大括号括起来的参数（如 `{var}`）。每个路径必须以斜杠（`/`）开头，以字母、数字或下划线（`_`）结尾。例如，`/my_endpoint/get_id`。
    - 对于用 `{ }` 括起来的参数，只允许使用字母、数字和下划线（`_`）。每个用 `{ }` 括起来的参数必须以字母或下划线（`_`）开头。

    > **注意：**
    >
    > - 在路径中，每个参数必须在单独的层级中，不支持前缀或后缀。
    >
    >    有效路径：```/var/{var}``` 和 ```/{var}```
    >
    >    无效路径：```/var{var}``` 和 ```/{var}var```
    >
    > - 具有相同方法和前缀的路径可能会冲突，如以下示例：
    >
    >    ```GET /var/{var1}```
    >
    >    ```GET /var/{var2}```
    >
    >   这两个路径会相互冲突，因为 `GET /var/123` 与两者都匹配。
    >
    > - 带参数的路径优先级低于不带参数的路径。例如：
    >
    >    ```GET /var/{var1}```
    >
    >    ```GET /var/123```
    >
    >   这两个路径不会冲突，因为 `GET /var/123` 优先。
    >
    > - 路径参数可以直接在 SQL 中使用。更多信息，请参见[配置参数](#配置参数)。

- **端点 URL**：（只读）默认 URL 根据相应集群所在的区域、Data App 的服务 URL 和端点的路径自动生成。例如，如果端点的路径是 `/my_endpoint/get_id`，则端点 URL 是 `https://<region>.data.tidbcloud.com/api/v1beta/app/<App ID>/endpoint/my_endpoint/get_id`。要为 Data App 配置自定义域名，请参见 [Data Service 中的自定义域名](/tidb-cloud/data-service-custom-domain.md)。

- **请求方法**：端点的 HTTP 方法。支持以下方法：

    - `GET`：用于查询或检索数据，如 `SELECT` 语句。
    - `POST`：用于插入或创建数据，如 `INSERT` 语句。
    - `PUT`：用于更新或修改数据，如 `UPDATE` 语句。
    - `DELETE`：用于删除数据，如 `DELETE` 语句。

- **描述**（可选）：端点的描述。

# 管理端点

Data Service（测试版）中的端点是一个可以自定义执行 SQL 语句的 Web API。你可以为 SQL 语句指定参数，例如在 `WHERE` 子句中使用的值。当客户端调用端点并在请求 URL 中提供参数值时，端点会使用提供的参数执行 SQL 语句，并将结果作为 HTTP 响应的一部分返回。

本文介绍如何在 TiDB Cloud 控制台中管理 Data App 中的端点。

## 开始之前

- 在创建端点之前，请确保以下内容：

    - 你已创建集群和 Data App。更多信息，请参见[创建 Data App](/tidb-cloud/data-service-manage-data-app.md#create-a-data-app)。
    - 端点将要操作的数据库、表和列已经存在于目标集群中。

- 在调用端点之前，请确保你已在 Data App 中创建了 API 密钥。更多信息，请参见[创建 API 密钥](/tidb-cloud/data-service-api-key.md#create-an-api-key)。

## 创建端点

在 Data Service 中，你可以自动生成端点、手动创建端点或添加预定义的系统端点。

> **提示：**
>
> 你也可以从 SQL Editor 中的 SQL 文件创建端点。更多信息，请参见[从 SQL 文件生成端点](/tidb-cloud/explore-data-with-chat2query.md#generate-an-endpoint-from-a-sql-file)。

### 自动生成端点

在 TiDB Cloud Data Service 中，你可以按以下方式一次性自动生成一个或多个端点：

1. 导航到项目的 [**Data Service**](https://tidbcloud.com/project/data-service) 页面。
2. 在左侧窗格中，找到目标 Data App，点击 App 名称右侧的 **+**，然后点击**自动生成端点**。此时会显示端点生成对话框。
3. 在对话框中，执行以下操作：

    1. 为要生成的端点选择目标集群、数据库和表。

        > **注意：**
        >
        > **表**下拉列表仅包含至少有一列的用户定义表，不包括系统表和没有列定义的表。

    2. 为要生成的端点选择至少一个 HTTP 操作（如 `GET（检索）`、`POST（创建）`和 `PUT（更新）`）。

        对于你选择的每个操作，TiDB Cloud Data Service 将生成一个相应的端点。如果你选择批量操作（如 `POST（批量创建）`），生成的端点允许你在单个请求中操作多行数据。

        如果你选择的表包含[向量数据类型](/tidb-cloud/vector-search-data-types.md)，你可以启用**向量搜索操作**选项并选择向量距离函数，以生成一个向量搜索端点，该端点会根据你选择的距离函数自动计算向量距离。支持的[向量距离函数](/tidb-cloud/vector-search-functions-and-operators.md)包括：

        - `VEC_L2_DISTANCE`（默认）：计算两个向量之间的 L2 距离（欧几里得距离）。
        - `VEC_COSINE_DISTANCE`：计算两个向量之间的余弦距离。
        - `VEC_NEGATIVE_INNER_PRODUCT`：使用两个向量之间内积的负值计算距离。
        - `VEC_L1_DISTANCE`：计算两个向量之间的 L1 距离（曼哈顿距离）。
       
    3. （可选）为操作配置超时时间和标签。所有生成的端点将自动继承配置的属性，可以根据需要稍后修改。
    4. （可选）**自动部署端点**选项（默认禁用）控制是否启用生成端点的直接部署。启用时，将跳过草稿审查过程，生成的端点将立即部署，无需进一步手动审查或批准。

4. 点击**生成**。

    生成的端点显示在端点列表的顶部。

5. 检查新端点的生成端点名称、SQL 语句、属性和参数。

    - 端点名称：生成的端点名称采用 `/<选择的表名>` 格式，请求方法（如 `GET`、`POST` 和 `PUT`）显示在端点名称之前。例如，如果选择的表名是 `sample_table` 且选择的操作是 `POST（创建）`，生成的端点显示为 `POST /sample_table`。

        - 如果选择了批量操作，TiDB Cloud Data Service 会在生成的端点名称后附加 `/bulk`。例如，如果选择的表名是 `/sample_table` 且选择的操作是 `POST（批量创建）`，生成的端点显示为 `POST /sample_table/bulk`。
        - 如果选择了 `POST（向量相似度搜索）`，TiDB Cloud Data Service 会在生成的端点名称后附加 `/vector_search`。例如，如果选择的表名是 `/sample_table` 且选择的操作是 `POST（向量相似度搜索）`，生成的端点显示为 `POST /sample_table/vector_search`。
        - 如果已经存在具有相同请求方法和端点名称的端点，TiDB Cloud Data Service 会在生成的端点名称后附加 `_dump_<随机字母>`。例如，`/sample_table_dump_EUKRfl`。

    - SQL 语句：TiDB Cloud Data Service 根据表列规范和选择的端点操作自动编写生成端点的 SQL 语句。你可以点击端点名称在页面中间部分查看其 SQL 语句。
    - 端点属性：TiDB Cloud Data Service 根据你的选择自动配置端点路径、请求方法、超时时间和标签。你可以在页面右侧窗格中找到这些属性。
    - 端点参数：TiDB Cloud Data Service 自动为生成的端点配置参数。你可以在页面右侧窗格中找到这些参数。

6. 如果你想修改生成端点的详细信息，如名称、SQL 语句、属性或参数，请参考[开发端点](#开发端点)中提供的说明。
